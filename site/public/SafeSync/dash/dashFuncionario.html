<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="imagem/png" href="../assets/img/logotipo.svg">
    <link rel="stylesheet" href="dashFuncionario.css">
    <link rel="stylesheet" href="./tarefas.css">
    <title>Dashboard</title>
</head>

<body>
    <main>

        <article>
            <nav class="menu-lateral" id="botao-expandir">
                <div class="botao_expandir">
                    <!-- <i class="bi bi-music-note-list" id="botao-expandir"></i> -->
                    <img src="../assets/img/logotipo.svg" alt="" width="60px">
                </div>
                <ul>
                    <li class="item-menu ativo" id="dashboard-link">
                        <a href="#">
                            <span class="icon">
                                <svg xmlns="http://www.w3.org/2000/svg" height="1.4em" fill="currentColor"
                                    class="bi bi-bar-chart-fill" viewBox="0 0 16 16">
                                    <path
                                        d="M1 11a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3zm5-4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7zm5-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V2z" />
                                </svg>
                            </span>
                            <span class="txt-link" >Dashboard</span>
                        </a>
                    </li>
                    <li class="item-menu" id="tarefas-link">
                        <a href="#">
                            <span class="icon" >
                                <svg xmlns="http://www.w3.org/2000/svg" height="1.4em" fill="currentColor"
                                    class="bi bi-journal-bookmark-fill" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd"
                                        d="M6 1h6v7a.5.5 0 0 1-.757.429L9 7.083 6.757 8.43A.5.5 0 0 1 6 8V1z" />
                                    <path
                                        d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z" />
                                    <path
                                        d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z" />
                                </svg>
                            </span>
                            <span class="txt-link tasks-link" >Tasks</span>
                        </a>
                    </li>
                   
                  
                    <li class="item-menu" id="item-menu-sair" onclick="window.location.href='../index.html'">
                        <a href="#">
                            <span class="icon-sair">
                                <svg xmlns="http://www.w3.org/2000/svg" height="1.4em" fill="rgb(151, 16, 16)"
                                    class="bi bi-box-arrow-left" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd"
                                        d="M6 12.5a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-1 0v-2A1.5 1.5 0 0 1 6.5 2h8A1.5 1.5 0 0 1 16 3.5v9a1.5 1.5 0 0 1-1.5 1.5h-8A1.5 1.5 0 0 1 5 12.5v-2a.5.5 0 0 1 1 0v2z" />
                                    <path fill-rule="evenodd"
                                        d="M.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L1.707 7.5H10.5a.5.5 0 0 1 0 1H1.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z" />
                                </svg>
                            </span>
                            <span class="txt-link-sair" >Sair</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </article>

        <article id="dash">
            <header id="header">
                <div id="titulosDash"> 
                    <h1 class="titulo">Dashboard</h1>
                    <h3><span id="nome_funcionario"></span> - Nome da empresa</h3>
                </div>
                <section class="opcoesTopo">
                    <div id="notificacao">
                        <svg xmlns="http://www.w3.org/2000/svg" height="1.4em"
                            viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                            <path
                                d="M224 0c-17.7 0-32 14.3-32 32V51.2C119 66 64 130.6 64 208v18.8c0 47-17.3 92.4-48.5 127.6l-7.4 8.3c-8.4 9.4-10.4 22.9-5.3 34.4S19.4 416 32 416H416c12.6 0 24-7.4 29.2-18.9s3.1-25-5.3-34.4l-7.4-8.3C401.3 319.2 384 273.9 384 226.8V208c0-77.4-55-142-128-156.8V32c0-17.7-14.3-32-32-32zm45.3 493.3c12-12 18.7-28.3 18.7-45.3H224 160c0 17 6.7 33.3 18.7 45.3s28.3 18.7 45.3 18.7s33.3-6.7 45.3-18.7z" />
                        </svg>
                    </div>
                    <div id="usuario">
                        <svg xmlns="http://www.w3.org/2000/svg" height="1.4em"
                            viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                            <path
                                d="M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z" />
                        </svg>
                    </div>
                </section>
            </header>

            <section id="areaGraficos">
                <article id="areaKpis">
                    <div class="kpi kpiTarefa">
                        <span class="tituloKpi">Tarefas Entregues no Mês</span>
                        <span class="kpiVerde valoresKpi" id="tarefasEntreguesFunc">0</span>
                    </div>
                    <div class="kpi kpiTarefa">
                        <span class="tituloKpi">Tarefas Pendentes</span>
                        <span class="kpiAmarela valoresKpi" id="tarefasPendentesFunc">0</span>
                    </div>
                    <div class="kpi kpiTarefa">
                        <span class="tituloKpi">Janelas Abertas</span>
                        <span class="valoresKpi kpiBranca" id="janelasAbertasFunc">7</span>
                    </div>
                    <div class="kpi kpiTarefa">
                        <span class="tituloKpi">N° de Alertas da máquina</span>
                        <span class="valoresKpi kpiVermelha" id="alertasMaquinaFunc">8</span>
                    </div>
                </article>
                <section>
                    <div class="graficos cpu">
                        <h3>Uso de Cpu</h3>
                        <div>
                            <canvas id="myChartLineCpu"></canvas>
                        </div>
                    </div>
                    <div class="graficos tarefas">
                        <h3>Tarefas atribuidas e entregues durante a semana </h3>
                        <div>
                            <canvas id="myChartLineTarefas"></canvas>
                        </div>
                    </div>                    
                    <div class="graficos disco">
                        <h3>Uso de  Disco</h3>
                        <div>
                            <canvas id="myChartLineDisco"></canvas>
                        </div>

                    </div>
                    <div class="graficos ram">
                        <h3>Uso de Ram</h3>
                        <div>
                            <canvas id="myChartLineRam"></canvas>
                        </div>
                    </div>
                </section>
                <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

            </section>

            <section id="areaTarefas" class="sectionsSumir" style="display: none;">
                <div class="accordion-container">
                    <div class="nomeLista">
                        <h1>GESTÃO DE TAREFAS</h1>
                    </div>
                    <div class="task-input">
                        <input type="text" id="taskInput" placeholder="Digite uma nova tarefa">
                            <label for="taskDate">Data de Entrega:</label>
                            <input type="date" id="taskDate">
                        <button onclick="addTask()">Adicionar Tarefa</button>
                    </div>
                    <div class="accordion" id="accordion">
                        <div class="accordion-item" id="tarefas" ondragover="allowDrop(event)" ondrop="drop(event)">
                            <div class="accordion-header" id="headerTarefas">Tarefas</div>
                            <div class="accordion-content" id="tarefasContent"></div>
                        </div>
                        <div class="accordion-item" id="afazer" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="accordion-header" id="headerAfazer">A Fazer</div>
                            <div class="accordion-content" id="afazerContent"></div>
                        </div>
                        <div class="accordion-item" id="andamento" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="accordion-header" id="headerAndamento">Em Andamento</div>
                            <div class="accordion-content" id="andamentoContent"></div>
                        </div>
                        <div class="accordion-item" id="concluido" ondrop="drop(event)" ondragover="allowDrop(event)">
                            <div class="accordion-header" id="headerConcluido">Concluído</div>
                            <div class="accordion-content" id="concluidoContent"></div>
                        </div>
                    </div>
                </div>
            </section>

            <div id="modalNotificacao" class="notificacaoModal">
                <div class="notificacaoModal-content">
                    <span class="closeNotificacao">&times;</span>
                    <!-- Conteúdo do modal aqui -->
                    <!-- Seu conteúdo modal aqui... -->
                    <section>
                        <div class="notificacaoCritico"><p>Uso da CPU crítico, acima dos 90%</p></div>
                        <div class="notificacaoBom"><p>Uso da CPU bom, abaixo dos 50%</p></div>
                        <div class="notificacaoAlerta"><p>Uso da CPU em alerta, acima dos 70%</p></div>
                        <div class="notificacaoAlerta"><p>Uso da CPU em alerta, acima dos 70%</p></div>
                        <div class="notificacaoAlerta"><p>Uso da CPU em alerta, acima dos 70%</p></div>
                        <div class="notificacaoAlerta"><p>Uso da CPU em alerta, acima dos 70%</p></div>
                        <div class="notificacaoAlerta"><p>Uso da CPU em alerta, acima dos 70%</p></div>
                        <div class="notificacaoAlerta"><p>Uso da CPU em alerta, acima dos 70%</p></div>
                        <div class="notificacaoAlerta"><p>Uso da CPU em alerta, acima dos 70%</p></div>
                        <div class="notificacaoAlerta"><p onclick="window.location.href='./dashFuncionario.html'">Uso da CPU em alerta, acima dos 70%</p></div>
           
                    </section>
                </div>
            </div>

            <div id="modalUsuario" class="usuarioModal">
                <div class="usuarioModal-content">
                    <span class="closeUsuario"></span>
                    <section>
                        <h1>Meu Perfil</h1>

                            <article>
                                <div id="imgPerfil"> <img src="../assets/img/exemploModelo.svg" alt=""></div>

                               
                                <div class="conteudoPerfil">
                                    <div class="iconeEditarPerfil"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-fill" viewBox="0 0 16 16">
                                        <path d="M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708l-3-3zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207l6.5-6.5zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.499.499 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11l.178-.178z"/>
                                      </svg></div>
                                    <p class="legendaPerfil primeiraLegenda">Nome</p>
                                    <p class="campoPerfil" id="perfil_nome"></p>
                                    <p class="legendaPerfil">Cargo</p>
                                    <p class="campoPerfil" id="perfil_cargo"></p>
                                    <p class="legendaPerfil">Email</p>
                                    <p class="campoPerfil" id="perfil_email"></p>
                                </div>
                            </article>
                    </section>
                </div>
            </div>

        </article>
    </main>
    <script src="./script/tarefas.js"></script>
</body>

</html>
<script src="./script/dash.js"></script>


<script>

    var nomeFuncionario = sessionStorage.NOME_FUNCIONARIO;
    var cargoFuncionario = sessionStorage.CARGO_FUNCIONARIO;
    var emailFuncionario = sessionStorage.EMAIL_FUNCIONARIO;
    var idFuncionario = sessionStorage.ID_FUNCIONARIO;

    nome_funcionario.innerHTML = nomeFuncionario;
    perfil_nome.innerHTML = nomeFuncionario;
    perfil_cargo.innerHTML = cargoFuncionario;
    perfil_email.innerHTML = emailFuncionario;

    // npm install moment-timezone


// ...

// Assumindo que `row` contém os resultados da consulta

// Agora `dataHoraBrasilia` deve conter a data e hora no fuso horário correto

    // ... (código anterior)

    let proximaAtualizacao;

// Função para obter dados do sensor e plotar o gráfico
function obterDadosGrafico(idHardware) {
    alterarTitulo(idHardware);

    if (proximaAtualizacao != undefined) {
        clearTimeout(proximaAtualizacao);
    }
    console.log(idHardware);
    console.log(idFuncionario);

    fetch(`/medidas/ultimas/${idFuncionario}/${idHardware}`).then(function (response) {
        if (response.ok) {
            response.json().then(function (resposta) {
                console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                resposta.reverse();
            

                plotarGrafico(resposta, idHardware);
                atualizacaoPeriodica(idHardware); // Adicione esta chamada para atualizar periodicamente
            });
        } else {
            console.error('Nenhum dado encontrado ou erro na API');
        }
    }).catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    });

    atualizacaoPeriodica(idHardware);

}

function atualizarGrafico(idHardware, dados, myChart) {



fetch(`/medidas/tempo-real/${idHardware}`).then(function (response) {
    console.log();
  if (response.ok) {
    response.json().then(function (novoRegistro) {

      console.log(`Dados recebidos: ${JSON.stringify(novoRegistro)}`);
      console.log(`Dados atuais do gráfico:`);
      console.log(dados);
      obterdados(idHardware)

      // let avisoCaptura = document.getElementById(``)
      // avisoCaptura.innerHTML = ""


      if (novoRegistro[0].momento_grafico == dados.labels[dados.labels.length - 1]) {
        console.log("---------------------------------------------------------------")
        console.log("Como não há dados novos para captura, o gráfico não atualizará.")
        // avisoCaptura.innerHTML = "<i class='fa-solid fa-triangle-exclamation'></i> Foi trazido o dado mais atual capturado pelo sensor. <br> Como não há dados novos a exibir, o gráfico não atualizará."
        console.log("Horário do novo dado capturado:")
        console.log(novoRegistro[0].momento_grafico)
        console.log("Horário do último dado capturado:")
        console.log(dados.labels[dados.labels.length - 1])
        console.log("---------------------------------------------------------------")
      } else {
        // tirando e colocando valores no gráfico
        dados.labels.shift(); // apagar o primeiro
        dados.labels.push(novoRegistro[0].momento_grafico); // incluir um novo momento

        dados.datasets[0].data.shift();  // apagar o primeiro de umidade
        dados.datasets[0].data.push(novoRegistro[0].umidade); // incluir uma nova medida de umidade

        dados.datasets[1].data.shift();  // apagar o primeiro de temperatura
        dados.datasets[1].data.push(novoRegistro[0].temperatura); // incluir uma nova medida de temperatura

        myChart.update();
      }

      // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
      proximaAtualizacao = setTimeout(() => atualizarGrafico(idHardware, dados, myChart), 15000);
    });
  } else {
    console.error('Nenhum dado encontrado ou erro na API');
    // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
    proximaAtualizacao = setTimeout(() => atualizarGrafico(idHardware, dados, myChart), 2000);
  }
})
  .catch(function (error) {
    console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
  });

}

function atualizacaoPeriodica() {
obterdados(1);
// function sendData() {
//     var http = new XMLHttpRequest();
//     http.open('POST', 'http://localhost:3000/api/sendData', false);
//     http.send(null);
// }

// setInterval(() => {
//     sendData();
// }, 2000);

setTimeout(atualizacaoPeriodica, 15000);
}
var chartCpu; 
function plotarGrafico(resposta, idSensor) {
    if (chartCpu) {
    // Se existir, destrua o gráfico
    chartCpu.destroy();
  }
    console.log('Iniciando plotagem do gráfico...');

    // Criando estrutura para plotar gráfico - labels
    let labels = [];

    // Criando estrutura para plotar gráfico - dados
    let dados = {
        labels: labels,
        datasets: [{
                label: 'Uso da Cpu', // Alterado para manter consistência
                data: [],
                fill: true,
                backgroundColor: '#adbcffa1',
                borderColor: '#adbcff',
                pointRadius: 4,
                tension: 0.4,
            }
        ]
    };

    console.log('----------------------------------------------')
    console.log('Estes dados foram recebidos pela função "obterDadosGrafico" e passados para "plotarGrafico":')
    console.log(resposta)

    // Inserindo valores recebidos na estrutura para plotar o gráfico
    for (i = 0; i < resposta.length; i++) {
        var registro = resposta[i];
        labels.push(registro.momento_grafico);
        dados.datasets[0].data.push(registro.umidade); // Alterado para manter consistência
    }

    console.log('----------------------------------------------')
    console.log('O gráfico será plotado com os respectivos valores:')
    console.log('Labels:')
    console.log(labels)
    console.log('Dados:')
    console.log(dados.datasets)
    console.log('----------------------------------------------')

    // Criando estrutura para plotar gráfico - config
    const config = {
        type: 'line',
        data: dados,
        options: {
            plugins: {
                legend: {
                    display: true,
                    labels: {
                        font: {
                            size: 9
                        }
                    }
                },
                tooltip: {
                    callbacks: {
                        title: function (tooltipItems) {
                            return 'Legenda:';
                        },
                        label: function (context) {
                            return 'Uso da Cpu: ' + context.parsed.y + '%';
                        }
                    }
                },
            },
            scales: {
                x: {
                    grid: {
                        display: false
                    },
                    ticks: {
                        font: {
                            size: 9
                        }
                    },
                },
                y: {
                    grid: {
                        display: false
                    },
                    ticks: {
                        font: {
                            size: 10
                        },
                        stepSize: 20, // Incremento desejado
                        max: 100, // Valor máximo do eixo y
                    },
                    beginAtZero: true
                }
            }
        }
    };

    // Adicionando gráfico criado em div na tela
    let myChart = new Chart(
        document.getElementById(`myChartLineCpu`),
        config
    );

    setTimeout(() => atualizarGrafico(idSensor, dados, myChart), 2000);
}

// Função para atualizar o gráfico periodicamente
function atualizacaoPeriodica(idHardware) {
    setTimeout(() => obterDadosGrafico(idHardware), 15000);
}

// ... (código posterior)

// Chame a função inicial para iniciar o processo
obterDadosGrafico(1); // Substitua o argumento pelo ID do sensor desejado




    
    const ctxRam = document.getElementById('myChartLineRam');

new Chart(ctxRam, {
    type: 'line',
    data: {
        labels: ['11:04', '11:05', '11:05', '11:06', '11:06', '11:07', '11:07', '11:08', '11:09', '11:09'],
        font: {
            size: 8
        },
        datasets: [{
            label: 'Uso da Ram',
            data: [0, 10, 10, 40, 40, 50, 60, 40, 80, 90, 100, 90, 85, 85, 80, 70, 80, 60, 60],
            fill: true,
            backgroundColor: '#adbcffa1', // Cor de preenchimento
            borderColor: '#adbcff',
            pointRadius: 4,
            tension: 0.4,
        }],
    },
    options: {
        plugins: {
            legend: {
                display: true,
                labels: {
                    font: {
                        size: 9
                    }
                }
            },
            tooltip: {
                callbacks: {
                    title: function (tooltipItems) {
                        return 'Legenda:';
                    },
                    label: function (context) {
                        return 'Uso da Ram: ' + context.parsed.y + '%';
                    }
                }
            }
        },
        scales: {
            x: {
                grid: {
                    display: false
                },
                ticks: {
                    font: {
                        size: 9
                    }
                },
            },
            y: {
                grid: {
                    display: false
                },
                ticks: {
                    font: {
                        size: 10
                    },
                    stepSize: 20, // Incremento desejado
                    max: 100, // Valor máximo do eixo y
                },
                beginAtZero: true
            }
        }
    }
});


    const ctxTarefas = document.getElementById('myChartLineTarefas');

new Chart(ctxTarefas, {
    type: 'bar',
    data: {
        labels: ['seg', 'ter', 'qua', 'qui', 'sex'],
        datasets: [{
            label: 'Tarefas Atribuidas',
            data: [4, 5, 10, 8, 7, 3],
            backgroundColor: '#fed0df', // Cor de preenchimento
            tension: 0.4,
        }, {
            label: 'Tarefas Entregues',
            data: [3, 6, 9, 9, 7, 3],
            backgroundColor: '#adbcff', // Cor de preenchimento
            tension: 0.4,
        }],
    },
    options: {
        plugins: {
            legend: {
                display: true,
                labels: {
                    font: {
                        size: 9
                    }
                }
            }
        },
        scales: {
            x: {
                grid: {
                    display: false
                },
                ticks: {
                    font: {
                        size: 9
                    }
                }
            },
            y: {
                grid: {
                    display: false
                },
                ticks: {
                    font: {
                        size: 11
                    }
                },
                beginAtZero: true
            }
        }
    }
});


const ctxDisco = document.getElementById('myChartLineDisco');

new Chart(ctxDisco, {
    type: 'doughnut',
    data: {
        labels: ['Livre', 'Usados'],
        datasets: [{
            label: 'Memória',
            data: [23, 77],
            fill: true,
            backgroundColor: [
                '#fed0df',
                '#adbcff'
            ],
            pointRadius: 2,
            tension: 0.4,
        }],
    },
    options: {
        plugins: {
            legend: {
                display: true,
                labels: {
                    font: {
                        size: 12
                    }
                }
            },
            tooltip: {
                callbacks: {
                    label: function (context) {
                        var labelIndex = context.dataIndex;
                        if (labelIndex === 0) {
                            return 'Memória Livre: ' + context.parsed + '%';
                        } else if (labelIndex === 1) {
                            return 'Memória Usada: ' + context.parsed + '%';
                        }
                    }
                }
            }
        },
    }
});

function alterarTitulo(idHardware) {
    var tituloEmpresa = document.getElementById(`tituloEmpresa${idHardware}`)
    myChartLineCpu.innerHTML = "Últimas medidas de Temperatura e Umidade do <span style='color: #e6005a'>Aquário " + idHardware + "</span>"
  }


function tarefasEntregues() {
    var idFuncionario = sessionStorage.ID_FUNCIONARIO;
    fetch(`/kpiFuncionario/tarefasEntregues/${idFuncionario}`)
        .then(function (response) {
            if (response.ok) {
                response.json().then(function (tarefas) {

                    tarefasEntreguesFunc.innerHTML = tarefas[0].total_tarefas_entregues;
                });
            }
        })
        .catch(function (error) {
            console.error(`Erro na obtenção dos dados: ${error.message}`);
        });
}
tarefasEntregues();

function tarefasPendentes() {
    var idFuncionario = sessionStorage.ID_FUNCIONARIO;
    fetch(`/kpiFuncionario/tarefasPendentes/${idFuncionario}`)
        .then(function (response) {
            if (response.ok) {
                response.json().then(function (tarefas) {

                    tarefasPendentesFunc.innerHTML = tarefas[0].total_tarefas_entregues;
                });
            }
        })
        .catch(function (error) {
            console.error(`Erro na obtenção dos dados: ${error.message}`);
        });
}
tarefasPendentes();

// Atualiza as tarefas a cada 5 segundos (por exemplo)
// setInterval(tarefasEntregues, 1000);

</script>